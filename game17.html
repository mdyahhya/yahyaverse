<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, orientation=landscape">
  <title>Dino Game Level 1</title>
  <style>
    html, body {
      width: 100%;
      height: 100%;
      overflow: hidden;
      background: #000;
      margin: 0;
      padding: 0;
      touch-action: none;
    }

    .gameScene {
      display: block;
      cursor: crosshair;
    }

    .game-ui {
      position: fixed;
      top: 20px;
      left: 20px;
      z-index: 100;
      color: white;
      font-size: 1.5rem;
      background: rgba(0,0,0,0.7);
      padding: 15px;
      border-radius: 10px;
      font-family: Arial, sans-serif;
    }

    .back-btn {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 100;
      background: #8B4513;
      border: none;
      padding: 15px 30px;
      color: white;
      border-radius: 25px;
      cursor: pointer;
      font-size: 1.2rem;
      text-decoration: none;
      font-family: Arial, sans-serif;
    }

    .game-complete {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0,0,0,0.9);
      color: white;
      padding: 40px;
      border-radius: 20px;
      text-align: center;
      z-index: 200;
      display: none;
      font-family: Arial, sans-serif;
    }

    .complete-title {
      font-size: 3rem;
      margin-bottom: 20px;
      color: #4CAF50;
    }

    .complete-btn {
      background: #4CAF50;
      border: none;
      padding: 15px 30px;
      color: white;
      border-radius: 25px;
      cursor: pointer;
      font-size: 1.2rem;
      margin: 10px;
      text-decoration: none;
      display: inline-block;
    }
  </style>
</head>
<body>
  <canvas class="gameScene"></canvas>

  <div class="game-ui">
    <div>Level: 1</div>
    <div>Coins: <span id="coinCount">0</span>/5</div>
  </div>

  
  <a href="index.html" class="back-btn">HOME</a>

  <div class="game-complete" id="gameComplete">
    <h2 class="complete-title">LEVEL 1 COMPLETE!</h2>
    <p>You collected 5 coins!</p>
    <a href="index.html" class="complete-btn">HOME</a>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

  <script>
    var c = $('.gameScene')[0],
        ctx = c.getContext("2d"),
        cw = (c.width = window.innerWidth),
        ch = (c.height = window.innerHeight),
        bg = [],
        fg = {img:new Image(), x:cw, top:540},
        dino = {img:new Image(), spriteOffsetX:0, x:cw/2, top:402},
        eyeLid = {img:new Image(), spriteOffsetX:0},
        dinoJump = {img:new Image(), spriteOffsetX:0, show:false},
        dinoJumpGlow = {img:new Image(), spriteOffsetX:0, show:false},
        dust1 = {img:new Image(), spriteOffsetX:0, x:0, y:0},
        dust2 = {img:new Image(), spriteOffsetX:0, x:0, y:0},
        coins = [],
        obstacles = [],
        coinsCollected = 0;

    // Create multiple coins instead of single coin
    for(let i = 0; i < 8; i++) {
      coins.push({
        img: new Image(),
        spriteOffsetX: 0,
        top: 200 + Math.random() * 100,
        right: 250 + i * 400,
        show: true,
        collected: false
      });
    }

    // Create obstacles
    // for(let i = 0; i < 5; i++) {
    //   obstacles.push({
    //     x: cw + 300 + i * 500,
    //     y: 450,
    //     width: 50,
    //     height: 100,
    //     color: '#8B4513'
    //   });
    // }

    // Mouse movement
    window.onmousemove = function(e){
      gsap.to(dino, {duration:2, x:e.clientX-250, overwrite:'auto'});
    }

    // Touch movement for mobile
    $(c).on('touchmove', function(e){
      e.preventDefault();
      var touch = e.originalEvent.touches[0];
      gsap.to(dino, {duration:2, x:touch.clientX-250, overwrite:'auto'});
    });

    // Click/Touch jump
    $(c).on('click touchstart', jump);
    $(window).on('keydown', function(e){
      if (e.keyCode == 32) {
        e.preventDefault();
        jump();
      }
    });

    function jump(e){
      e.preventDefault();
      if (dinoJump.show) return;
      dinoJump.show=true;

      gsap.timeline({ onComplete:function(){dinoJump.show=false} })
        .fromTo(dinoJump, {spriteOffsetX:0}, {duration:0.5, spriteOffsetX:1250, ease:'steps(5)'})
        .call(function(){ 
          // Check coin collection
          coins.forEach((coin, index) => {
            if (coin.show && !coin.collected && cw-dino.x < coin.right+100 && cw-dino.x > coin.right-100) {
              coin.collected = true;
              coin.show = false;
              coinsCollected++;
              document.getElementById('coinCount').textContent = coinsCollected;
              gsap.to(dinoJumpGlow, {duration:0.3, spriteOffsetX:750, ease:'steps(3)'});

              if(coinsCollected >= 5) {
                setTimeout(() => {
                  document.getElementById('gameComplete').style.display = 'block';
                }, 500);
              }
            }
          });
      }, null, 0.25)
    }

    // Load images
    dino.img.src='https://assets.codepen.io/721952/gameDino.png';
    eyeLid.img.src='https://assets.codepen.io/721952/gameBlink.png';
    dinoJump.img.src='https://assets.codepen.io/721952/gameJump.png';
    dinoJumpGlow.img.src='https://assets.codepen.io/721952/gameJumpGlow.png';

    // Dino walking animation
    gsap.to(dino, {duration:0.55, spriteOffsetX:1400, ease:'steps(5)', repeat:-1, onRepeat:function(){
      if (Math.random()<0.4) gsap.fromTo(eyeLid, {spriteOffsetX:0},{duration:0.55, spriteOffsetX:1400, ease:'steps(5)'}); //random blinking
    }});
    gsap.to(dino, {duration:1.2, top:416, ease:'power1.inOut', yoyo:true, repeat:-1});

    // Dust effects
    dust1.img.src=dust2.img.src='https://assets.codepen.io/721952/gameDust.png';
    gsap.to(dust1, {duration:0.6, spriteOffsetX:975, ease:'steps(13)', repeat:-1});
    gsap.fromTo(dust1, {x:function(){return dino.x+70}}, {duration:0.6, repeat:-1, ease:'sine', x:'-=100', repeatRefresh:true});
    gsap.fromTo(dust1, {y:function(){return dino.top+95}}, {duration:0.6, repeat:-1, ease:'sine.in', y:'-=50', repeatRefresh:true});
    gsap.to(dust2, {duration:0.6, delay:0.2, spriteOffsetX:975, ease:'steps(13)', repeat:-1});
    gsap.fromTo(dust2, {x:function(){return dino.x+70}}, {delay:0.2, duration:0.6, repeat:-1, ease:'sine', x:'-=150', repeatRefresh:true});
    gsap.fromTo(dust2, {y:function(){return dino.top+95}}, {delay:0.2, duration:0.6, repeat:-1, ease:'sine.in', y:'-=30', repeatRefresh:true});

    // Foreground elements
    fg.img.src='https://assets.codepen.io/721952/gameFg.png';
    fg.img.onload = moveFg;
    function moveFg(){
      if (gsap.isTweening(fg)) return;
      gsap.fromTo(fg, {x:cw}, {duration:gsap.utils.random(2,3), x:-350, ease:'none'});
      gsap.delayedCall(gsap.utils.random(3,5), moveFg);
    }

    // Coin animations
    coins.forEach((coin, i) => {
      coin.img.src='https://assets.codepen.io/721952/gameCoin.png';
      var cTL = gsap.timeline({paused:true}).to(coin, {spriteOffsetX:400, ease:'steps(5)', repeat:4});
      gsap.to(cTL, {progress:1, duration:1.2, ease:'sine.inOut', repeat:-1, delay: i * 0.1});
      gsap.to(coin, {duration:0.6, yoyo:true, repeat:-1, top:coin.top + 20, ease:'sine.inOut', delay: i * 0.1});
    });

    // Background layers
    for (var i=0; i<5; i++){
      var img = new Image();
      img.id = i;
      img.src = (i==0) ? 'https://assets.codepen.io/721952/gameLayer0.jpg' : 'https://assets.codepen.io/721952/gameLayer'+i+'.png';
      img.onload = makeLayer;    
    }

    function makeLayer(e){ 
      var l = {
        img:e.currentTarget,
        fill:ctx.createPattern(e.currentTarget, 'repeat'),
        x:0,
        y:[55,55,55,0,525][Number(e.currentTarget.id)],
        width:e.currentTarget.width,
        height:e.currentTarget.height
      }
      bg.push(l);
      l.tl = gsap.timeline({repeat:-1}).to(l, {x:-e.currentTarget.width, ease:'none', duration:6-Number(e.currentTarget.id)});

      bg.sort(function(a,b){// sort layers to maintain correct z-stacking
        return (a.img.id>b.img.id) ? 1:-1;
      })
    }

    // Main game loop
    gsap.ticker.add((a,b,c)=>{
      cw = ($('.gameScene')[0].width = window.innerWidth);
      ch = ($('.gameScene')[0].height = window.innerHeight);

      // Draw background layers
      for (var i=0; i<bg.length; i++){
        ctx.fillStyle = bg[i].fill;
        ctx.translate(bg[i].x, bg[i].y);
        ctx.fillRect(0, 0, cw+bg[i].width, bg[i].height);
        ctx.translate(-bg[i].x, -bg[i].y);      
      }

      // Draw obstacles
      obstacles.forEach(obstacle => {
        obstacle.x -= 2;
        if(obstacle.x < -100) {
          obstacle.x = cw + Math.random() * 400;
        }

        // Check collision with obstacle
        if(Math.abs(obstacle.x - dino.x) < 100 && Math.abs(obstacle.y - dino.top) < 80 && !dinoJump.show) {
          // Reset obstacle position instead of game over
          obstacle.x = cw + Math.random() * 400;
        }

        ctx.fillStyle = obstacle.color;
        ctx.fillRect(obstacle.x, obstacle.y, obstacle.width, obstacle.height);
      });

      // Draw dust effects
      if (!dinoJump.show) ctx.drawImage(dust1.img, dust1.spriteOffsetX,0,75,55, dust1.x,dust1.y,75,55);

      // Draw dino
      if (dinoJump.show) ctx.drawImage(dinoJump.img, dinoJump.spriteOffsetX,0,250,240, dino.x,dino.top-100,250,240);
      else {
        ctx.drawImage(dino.img, dino.spriteOffsetX,0,280,140, dino.x,dino.top,280,140);
        ctx.drawImage(eyeLid.img, eyeLid.spriteOffsetX,0,280,140, dino.x,dino.top,280,140);
      }
      ctx.drawImage(dust2.img, dust2.spriteOffsetX,0,75,55, dust2.x,dust2.y,75,55);

      // Draw coins
      coins.forEach(coin => {
        if (coin.show && !coin.collected) {
          ctx.globalCompositeOperation = 'screen';
          ctx.drawImage(coin.img, coin.spriteOffsetX,0,80,80,cw-coin.right,coin.top,80,80);
          ctx.globalCompositeOperation = 'source-over';
        }
      });

      // Draw glow effect
      if (!coins.some(coin => coin.show && !coin.collected)) {
        ctx.drawImage(dinoJumpGlow.img, dinoJumpGlow.spriteOffsetX,0,250,240,dino.x,dino.top-100,250,240);
      }

      // Draw foreground
      ctx.drawImage(fg.img, fg.x,fg.top,350,90);
    });
  </script>
</body>
</html>
